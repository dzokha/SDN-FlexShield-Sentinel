<!DOCTYPE html>
<html lang="vi">
<head>
  <meta charset="UTF-8">
  <style>
    :root {
      --bg-gradient: radial-gradient(circle at 50% 10%, #1e293b 0%, #0f172a 100%);
      --card-bg: rgba(30, 41, 59, 0.5);
      --glass-border: rgba(255, 255, 255, 0.08);
      --primary: #38bdf8;
      --success: #10b981;
      --warning: #f59e0b;
      --danger: #ef4444;
      --text-main: #f8fafc;
      --text-muted: #94a3b8;
    }

    body {
      width: 340px;
      margin: 0;
      font-family: 'Inter', system-ui, -apple-system, sans-serif;
      background: var(--bg-gradient);
      color: var(--text-main);
      overflow-x: hidden;
    }

    .container { padding: 20px; }

    /* --- HEADER --- */
    .header {
      display: flex;
      align-items: center;
      padding-bottom: 15px;
      border-bottom: 1px solid var(--glass-border);
      margin-bottom: 20px;
    }

    .header-logo {
      width: 36px;
      height: 36px;
      filter: drop-shadow(0 0 8px rgba(56, 189, 248, 0.3));
      margin-right: 12px;
    }

    .header-info h1 {
      margin: 0;
      font-size: 14px;
      font-weight: 800;
      color: var(--primary);
      text-transform: uppercase;
      letter-spacing: 0.5px;
    }
    
    .header-info span {
      font-size: 10px;
      color: var(--text-muted);
    }

    /* Nút Refresh đặt bên phải */
    .header-actions {
      margin-left: auto; /* Đẩy sang phải */
    }

    .btn-refresh {
      background: transparent;
      border: 1px solid var(--glass-border);
      border-radius: 8px;
      width: 32px;
      height: 32px;
      display: flex;
      align-items: center;
      justify-content: center;
      cursor: pointer;
      color: var(--text-muted);
      transition: all 0.3s ease;
    }

    .btn-refresh:hover {
      background: rgba(255, 255, 255, 0.05);
      color: var(--primary);
      border-color: var(--primary);
    }

    .btn-refresh svg {
      width: 16px;
      height: 16px;
      fill: currentColor;
    }

    /* Hiệu ứng xoay khi click */
    .spinning {
      animation: spin 0.8s linear infinite;
      color: var(--primary);
      pointer-events: none; /* Khóa click khi đang chạy */
    }

    @keyframes spin { 100% { transform: rotate(360deg); } }

    /* --- GAUGE & INFO --- */
    /* (Giữ nguyên CSS phần trước để tiết kiệm không gian, chỉ thay đổi Header) */
    .gauge-wrapper { position: relative; width: 140px; height: 140px; margin: 0 auto 20px; display: flex; align-items: center; justify-content: center; }
    .gauge-svg { transform: rotate(-90deg); width: 100%; height: 100%; }
    .gauge-bg { fill: none; stroke: rgba(255,255,255,0.05); stroke-width: 8; }
    .gauge-progress { fill: none; stroke: var(--success); stroke-width: 8; stroke-linecap: round; stroke-dasharray: 377; stroke-dashoffset: 377; transition: stroke-dashoffset 1s cubic-bezier(0.4, 0, 0.2, 1), stroke 0.5s; }
    .score-display { position: absolute; text-align: center; }
    .score-number { font-size: 36px; font-weight: 900; line-height: 1; text-shadow: 0 0 20px rgba(0,0,0,0.5); }
    .score-text { font-size: 9px; text-transform: uppercase; letter-spacing: 1px; margin-top: 4px; opacity: 0.8; }

    .info-card { background: var(--card-bg); backdrop-filter: blur(10px); border: 1px solid var(--glass-border); border-radius: 12px; padding: 15px; margin-bottom: 20px; box-shadow: 0 4px 20px rgba(0,0,0,0.2); }
    .info-row { display: flex; justify-content: space-between; align-items: center; margin-bottom: 10px; font-size: 11px; border-bottom: 1px dashed rgba(255,255,255,0.1); padding-bottom: 8px; }
    .info-row:last-child { border-bottom: none; padding-bottom: 0; margin-bottom: 0; }
    .info-label { color: var(--text-muted); font-weight: 600; }
    .info-value { font-family: 'JetBrains Mono', monospace; color: #fff; text-align: right; }

    .status-badge { margin-top: 15px; padding: 10px; border-radius: 8px; text-align: center; transition: all 0.3s; }
    .status-badge .main-text { font-size: 13px; font-weight: 800; display: block; margin-bottom: 2px;}
    .status-badge .sub-text { font-size: 10px; opacity: 0.8; display: block; }
    .bg-safe { background: rgba(16, 185, 129, 0.1); border: 1px solid rgba(16, 185, 129, 0.3); color: var(--success); }
    .bg-danger { background: rgba(239, 68, 68, 0.1); border: 1px solid rgba(239, 68, 68, 0.3); color: var(--danger); }

    .risk-header { font-size: 10px; font-weight: 700; color: var(--text-muted); margin-bottom: 10px; display: flex; justify-content: space-between; text-transform: uppercase; }
    .risk-item { font-size: 11px; padding: 8px 12px; background: rgba(239, 68, 68, 0.05); border-left: 3px solid var(--danger); margin-bottom: 6px; border-radius: 0 4px 4px 0; color: #fca5a5; animation: slideIn 0.3s ease-out forwards; }
    .clean-env { text-align: center; padding: 15px; color: var(--success); font-size: 11px; background: rgba(16, 185, 129, 0.05); border-radius: 8px; border: 1px dashed rgba(16, 185, 129, 0.3); }
    @keyframes slideIn { from { opacity: 0; transform: translateX(-10px); } to { opacity: 1; transform: translateX(0); } }

    .footer { text-align: center; font-size: 9px; color: var(--text-muted); margin-top: 25px; opacity: 0.6; }
    .footer a { color: var(--text-muted); text-decoration: none; border-bottom: 1px dotted var(--text-muted); }
  </style>
</head>
<body>
  <div class="container">
    <div class="header">
      <img src="images/logo.png" alt="Logo" class="header-logo" onerror="this.style.display='none'">
      <div class="header-info">
        <h1>SDN-FlexShield</h1>
        <span>Sentinel Module v1.2</span>
      </div>
      
      <div class="header-actions">
        <button id="refresh-btn" class="btn-refresh" title="Re-scan Target">
          <svg viewBox="0 0 24 24">
            <path d="M17.65 6.35C16.2 4.9 14.21 4 12 4c-4.42 0-7.99 3.58-7.99 8s3.57 8 7.99 8c3.73 0 6.84-2.55 7.73-6h-2.08c-.82 2.33-3.04 4-5.65 4-3.31 0-6-2.69-6-6s2.69-6 6-6c1.66 0 3.14.69 4.22 1.78L13 11h7V4l-2.35 2.35z"/>
          </svg>
        </button>
      </div>
    </div>

    <div class="gauge-wrapper">
      <svg class="gauge-svg" viewBox="0 0 140 140">
        <circle class="gauge-bg" cx="70" cy="70" r="60"></circle>
        <circle class="gauge-progress" id="progress-circle" cx="70" cy="70" r="60"></circle>
      </svg>
      <div class="score-display">
        <div class="score-number" id="score-text">0</div>
        <div class="score-text" id="risk-label">Analyzing</div>
      </div>
    </div>

    <div class="info-card">
      <div class="info-row">
        <span class="info-label">TARGET DOMAIN</span>
        <span id="domain" class="info-value">--</span>
      </div>
      <div class="info-row">
        <span class="info-label">RESOLVED IP</span>
        <span id="ip" class="info-value">Scanning...</span>
      </div>
      
      <div id="status-badge" class="status-badge bg-safe">
        <span class="main-text">Analyzing Protocol...</span>
        <span class="sub-text">(Đang phân tích giao thức)</span>
      </div>
    </div>

    <div class="risk-header">
      <span>Threat Analysis</span>
      <span id="indicator-count" style="color: var(--primary)">0/7</span>
    </div>
    
    <div id="risk-list"></div>

    <div class="footer">
      Research Prototype | MIT License<br>
      Developed by <a href="https://dzokha.vn" target="_blank">Dzokha</a>
    </div>
  </div>
  <script src="popup.js"></script>
</body>
</html>